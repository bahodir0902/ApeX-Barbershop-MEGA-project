{% extends "base.html" %}
{% block title %} {{ user.first_name }}  {{ user.last_name }} {% endblock %}

{% block head_links %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/barber-page.css') }}">
<script src="{{ url_for('static', filename='js/barber-page.js') }}"></script>
{% endblock %}

{% block content %}

<div class="container mt-5" id="manage-haircuts-container">
    <h1 class="text-center mb-4">Manage My Haircuts</h1>

    <!-- Add Haircut Section -->
    <div class="card shadow-sm mb-4">
        <div class="card-header"
             style="display: flex; justify-content: space-between; align-items: center; bg-primary: text-white;">
            <h5 class="mb-0">Add New Haircut</h5>
            <button class="btn btn-link text-white p-0" id="add-haircut-toggle-card-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="card-body collapse" id="add-haircut-card-content" style="display: none;">
            <form id="add-haircut-form" enctype="multipart/form-data" method="POST"
                  action="{{ url_for('barber_page.add_haircut') }}">
                <div class="form-group mb-3">
                    <label for="haircut-name" class="form-label">Haircut Name</label>
                    <input type="text" class="form-control" id="haircut-name" name="haircut-name"
                           placeholder="Enter haircut name" required>
                </div>
                <div class="form-group mb-3">
                    <label for="haircut-price" class="form-label">Haircut Price (sum)</label>
                    <input type="number" class="form-control" id="haircut-price" name="haircut-price"
                           placeholder="Enter price" required>
                </div>
                <div class="form-group mb-3">
                    <label for="haircut-description" class="form-label">Haircut Description</label>
                    <textarea class="form-control" id="haircut-description" name="haircut-description" rows="3"
                              placeholder="Enter description" required></textarea>
                </div>
                <div class="form-group mb-4">
                    <label for="haircut-picture" class="form-label">Upload Haircut Picture</label>
                    <input type="file" class="form-control" id="haircut-picture" name="haircut-picture" required>
                </div>
                <button type="submit" class="btn btn-success w-100 add-haircut-button">Add Haircut</button>
            </form>
        </div>
    </div>

    <!-- Edit haircut section -->
    <div class="card shadow-sm mb-4">
        <div class="card-header"
             style="display: flex; justify-content: space-between; align-items: center; bg-primary: text-white; margin-top: 30px;">
            <h5 class="mb-0">Edit my haircuts</h5>
            <button class="btn btn-link text-white p-0" id="edit-haircut-toggle-card-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="card-body collapse" id="edit-haircut-card-content" style="display: none;">

            <form id="edit-haircut-form" enctype="multipart/form-data" method="POST"
                  action="{{ url_for('barber_page.edit_haircut') }}">
                <div class="form-group mb-3">
                    <label for="select-haircut" class="form-label">Select Haircut to Edit</label>
                    <select class="form-control" id="select-haircut" name="selected_haircut">
                        <option value="" disabled selected>Select a haircut</option>
                        {% for haircut in haircuts %}
                        <option value="{{ haircut[0] }}"
                                data-name="{{ haircut[1] }}"
                                data-price="{{ haircut[3] }}"
                                data-description="{{ haircut[2] }}">
                            {{ haircut[1] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>


                <div class="form-group mb-3">
                    <label for="haircut-name" class="form-label">Haircut Name</label>
                    <input type="text" class="form-control" id="edit-name" name="haircut-name"
                           placeholder="Enter haircut name">
                </div>
                <div class="form-group mb-3">
                    <label for="haircut-price" class="form-label">Haircut Price (sum)</label>
                    <input type="number" class="form-control" id="edit-haircut-price" name="haircut-price"
                           placeholder="Enter price">
                </div>
                <div class="form-group mb-3">
                    <label for="haircut-description" class="form-label">Haircut Description</label>
                    <textarea class="form-control" id="edit-haircut-description" name="haircut-description" rows="3"
                              placeholder="Enter description"></textarea>
                </div>
                <div class="form-group mb-4">
                    <label for="haircut-picture" class="form-label">Upload Haircut Picture</label>
                    <input type="file" class="form-control" id="edit-haircut-picture" name="haircut-picture">
                </div>

                <button type="submit" class="btn btn-success w-100 add-haircut-button">Confirm changes</button>
            </form>

        </div>
    </div>

    <!-- Delete haircut section -->
    <div class="card shadow-sm mb-4">
        <div class="card-header"
             style="display: flex; justify-content: space-between; align-items: center; bg-primary: text-white; margin-top: 30px;">
            <h5 class="mb-0">Delete my haircuts</h5>
            <button class="btn btn-link text-white p-0" id="delete-haircut-toggle-card-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="card-body collapse" id="delete-haircut-card-content" style="display: none;">

            <form id="delete-haircut-form" method="POST"
                  action="{{ url_for('barber_page.delete_haircut') }}">
                <div class="form-group mb-3">
                    <label for="select-haircut" class="form-label">Select Haircut to Edit</label>
                    <select class="form-control" id="select-haircut-to-delete" name="selected_haircut">
                        <option value="" disabled selected>Select a haircut</option>
                        {% for haircut in haircuts %}
                        <option value="{{ haircut[0] }}"
                                data-name="{{ haircut[1] }}"
                                data-price="{{ haircut[3] }}"
                                data-description="{{ haircut[2] }}">
                            {{ haircut[1] }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="delete-haircut-container">
                    <p style="margin-top: 50px;">Note that after deleting this haircut all its data in the system will
                        be
                        <strong>deleted permanently.</strong></p>
                    <button type="submit" id="delete-haircut-btn" class="delete-haircut-btn"
                            style="margin-top: 25px; margin-left: 10px; background-color: grey; cursor: not-allowed;"
                            disabled>Delete haircut
                    </button>
                </div>

            </form>

        </div>
    </div>

</div>


<div class="container mt-5" id="manage-appointments-container">
    <h1 class="text-center">Manage my appointments</h1>

    <!--Upcoming appointments section -->
    <div class="card shadow-sm mb-4">
        <div class="card-header"
             style="display: flex; justify-content: space-between; align-items: center; bg-primary: text-white;">
            <h5 class="mb-0">Upcoming appointments</h5>
            <button class="btn btn-link text-white p-0" id="upcoming-appointments-toggle-card-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="card-body collapse" id="upcoming-appointments-content" style="display: none;">
            {% for appointment in appointments %}
            <div class="appointment-body">

                <p class="appointment-id">Appointment ID: {{ appointment[0] }}</p>
                <p class="appointment-time">Appointment Time: {{ appointment[1] }}</p>
                <p class="appointment-date">Appointment Date: {{ appointment[2] }}</p>
                <p class="customer-first-name">Customer First Name: {{ appointment[3] }}</p>
                <p class="customer-last-name">Customer Last Name: {{ appointment[4] }}</p>
                <p class="customer-phone-number">Customer Phone Number: {{ appointment[5] }}</p>
                <p class="customer-email">Customer email: {{ appointment[6] }}</p>
                <p class="haircut-name">Haircut Name: {{ appointment[7] }}</p>
                <p class="price">price: {{ appointment[8] }} sum</p>
                <p class="duration-minutes">Duration: {{ appointment[9] }} minutes</p>
                <p class="created-date">Created date: {{ appointment[10] }}</p>
                <form class="finish-appointments-container" method="POST" action="/finish-appointment">
                    <input type="hidden" name="appointment_id" value="{{ appointment[0] }}">
                    <button type="submit" class="finish-appointments-button">Set as finished</button>
                </form>
                <form class="delete-appointments-container" method="POST" action="/cancel-appointment">
                    <input type="hidden" name="appointment_id" value="{{ appointment[0] }}">
                    <button type="submit" class="delete-appointment-button">Cancel appointment</button>
                    <p>Important: Please ensure you contact the customer prior to deleting this appointment. Note that
                        deleting an appointment will automatically result in its cancellation.</p>
                </form>
            </div>


            {% endfor %}
        </div>
    </div>

    <!-- Finished appointments section-->
    <div class="card shadow-sm mb-4" style="margin-top: 20px;">
        <div class="card-header"
             style="display: flex; justify-content: space-between; align-items: center; bg-primary: text-white;">
            <h5 class="mb-0">Finished Appointments</h5>
            <button class="btn btn-link text-white p-0" id="finished-haircuts-toggle-card-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="card-body collapse" id="finished-haircuts-content" style="display: none;">
            {% for appointment in finished_appointments %}
            <div class="appointment-body">
                <p class="appointment-id">Appointment ID: {{ appointment[0] }}</p>
                <p class="appointment-time">Appointment Time: {{ appointment[1] }}</p>
                <p class="appointment-date">Appointment Date: {{ appointment[2] }}</p>
                <p class="customer-first-name">Customer First Name: {{ appointment[3] }}</p>
                <p class="customer-last-name">Customer Last Name: {{ appointment[4] }}</p>
                <p class="customer-phone-number">Customer Phone Number: {{ appointment[5] }}</p>
                <p class="customer-email">Customer email: {{ appointment[6] }}</p>
                <p class="haircut-name">Haircut Name: {{ appointment[7] }}</p>
                <p class="price">price: {{ appointment[8] }} sum</p>
                <p class="duration-minutes">Duration: {{ appointment[9] }} minutes</p>
                <p class="created-date">Created date: {{ appointment[10] }}</p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!--Canceled appointments section -->
    <div class="card shadow-sm mb-4" style="margin-top: 20px;">
        <div class="card-header"
             style="display: flex; justify-content: space-between; align-items: center; bg-primary: text-white;">
            <h5 class="mb-0">Canceled Appointments</h5>
            <button class="btn btn-link text-white p-0" id="canceled-appointments-toggle-card-btn">
                <i class="fas fa-plus"></i>
            </button>
        </div>
        <div class="card-body collapse" id="canceled-appointments-content" style="display: none;">
            {% for appointment in canceled_appointments %}
            <div class="appointment-body">
                <p class="appointment-id">Appointment ID: {{ appointment[0] }}</p>
                <p class="appointment-time">Appointment Time: {{ appointment[1] }}</p>
                <p class="appointment-date">Appointment Date: {{ appointment[2] }}</p>
                <p class="customer-first-name">Customer First Name: {{ appointment[3] }}</p>
                <p class="customer-last-name">Customer Last Name: {{ appointment[4] }}</p>
                <p class="customer-phone-number">Customer Phone Number: {{ appointment[5] }}</p>
                <p class="customer-email">Customer email: {{ appointment[6] }}</p>
                <p class="haircut-name">Haircut Name: {{ appointment[7] }}</p>
                <p class="price">price: {{ appointment[8] }} sum</p>
                <p class="duration-minutes">Duration: {{ appointment[9] }} minutes</p>
                <p class="created-date">Created date: {{ appointment[10] }}</p>
            </div>
            {% endfor %}
        </div>
    </div>

</div>

{% endblock %}

{% block scripts %}

{% endblock %}
